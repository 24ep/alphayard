
> bondarys-backend@1.0.0 dev
> nodemon --exec ts-node src/server.ts

[33m[nodemon] 3.1.11[39m
[33m[nodemon] to restart at any time, enter `rs`[39m
[33m[nodemon] watching path(s): *.*[39m
[33m[nodemon] watching extensions: ts,json[39m
[32m[nodemon] starting `ts-node src/server.ts`[39m
node.exe : ΓÜá∩╕Å AWS SDK not installed - using local storage only
At line:1 char:1
+ & "C:\Program Files\nodejs/node.exe" "C:\Program Files\nodejs/node_mo ...
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (ΓÜá∩╕Å AWS SDK ...al storage only:String) [], RemoteException
    + FullyQualifiedErrorId : NativeCommandError
 
ΓÜá∩╕Å AWS S3 not configured - using local storage
≡ƒöô Rate limiting disabled in development mode
Γ£à Database pool configuration loaded
Socket.IO server initialized
Γ£à Socket.IO initialized
≡ƒÜÇ Bondarys Backend Server running on 0.0.0.0:4000
≡ƒîì Environment: development
≡ƒÅÑ Health check: http://0.0.0.0:4000/health
≡ƒôè Metrics: http://0.0.0.0:4000/metrics
≡ƒöî Socket.IO: ws://0.0.0.0:4000
[32minfo[39m: Request started {"ip":"127.0.0.1","method":"GET","requestId":"f3c300a5-cebf-445a-acd7-dd3e09a6258d","service":"bondarys-api","timestamp":"2026-01-03T08:40:23.286Z","url":"/api/v1/auth/me","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36 Edg/143.0.0.0"}
[32minfo[39m: Request completed {"duration":"5ms","ip":"127.0.0.1","method":"GET","requestId":"f3c300a5-cebf-445a-acd7-dd3e09a6258d","service":"bondarys-api","statusCode":401,"timestamp":"2026-01-03T08:40:23.291Z","url":"/me"}
[32minfo[39m: Request started {"ip":"127.0.0.1","method":"GET","requestId":"d977ade3-780d-4e05-b93d-87288d3f807b","service":"bondarys-api","timestamp":"2026-01-03T08:40:26.919Z","url":"/api/app-config/assets/logo_white","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36 Edg/143.0.0.0"}
[32minfo[39m: Request started {"ip":"127.0.0.1","method":"GET","requestId":"f91b3386-79f3-4b9d-a58a-91e542280043","service":"bondarys-api","timestamp":"2026-01-03T08:40:26.928Z","url":"/api/app-config/screens/login_screen","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36 Edg/143.0.0.0"}
[32minfo[39m: Request completed {"duration":"14ms","ip":"127.0.0.1","method":"GET","requestId":"f91b3386-79f3-4b9d-a58a-91e542280043","service":"bondarys-api","statusCode":304,"timestamp":"2026-01-03T08:40:26.942Z","url":"/screens/login_screen"}
[APP_CONFIG] Asset not found: logo_white. Returning fallback.
[32minfo[39m: Request completed {"duration":"26ms","ip":"127.0.0.1","method":"GET","requestId":"d977ade3-780d-4e05-b93d-87288d3f807b","service":"bondarys-api","statusCode":304,"timestamp":"2026-01-03T08:40:26.945Z","url":"/assets/logo_white"}
[32minfo[39m: Request started {"ip":"127.0.0.1","method":"POST","requestId":"4fb62543-50e1-4257-85a9-c56d4698e6a9","service":"bondarys-api","timestamp":"2026-01-03T08:40:29.994Z","url":"/api/v1/auth/check-user","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36 Edg/143.0.0.0"}
[AUTH DEBUG] RAW REQUEST BODY: {"email":"jaroonwitpool@gmail.com"}
[AUTH DEBUG] checkUserExistence - email: "jaroonwitpool@gmail.com", phone: "undefined"
[UserModel.findOne] Executing SQL: SELECT u.id, u.email, u.encrypted_password as password, u.created_at, u.email_confirmed_at, p.full_name, p.avatar_url, p.phone, (SELECT json_agg(family_id) FROM family_members WHERE user_id = u.id) as family_ids, u.raw_user_meta_data as metadata FROM auth.users u LEFT JOIN public.profiles p ON u.id = p.id WHERE 1=1 AND u.email = $1
[UserModel.findOne] With params: [ 'jaroonwitpool@gmail.com' ]
[UserModel.findOne] Result rows: 1
[AUTH DEBUG] findByEmail result: Found user ID: f739edde-45f8-4aa9-82c8-c1876f434683
[AUTH] Check user existence for jaroonwitpool@gmail.com: true
[32minfo[39m: Request completed {"duration":"30ms","ip":"127.0.0.1","method":"POST","requestId":"4fb62543-50e1-4257-85a9-c56d4698e6a9","service":"bondarys-api","statusCode":200,"timestamp":"2026-01-03T08:40:30.024Z","url":"/check-user"}
[32minfo[39m: Request started {"ip":"127.0.0.1","method":"POST","requestId":"88232283-285c-498f-a221-162777a9fcd5","service":"bondarys-api","timestamp":"2026-01-03T08:40:30.029Z","url":"/api/v1/auth/otp/request","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36 Edg/143.0.0.0"}
[UserModel.findOne] Executing SQL: SELECT u.id, u.email, u.encrypted_password as password, u.created_at, u.email_confirmed_at, p.full_name, p.avatar_url, p.phone, (SELECT json_agg(family_id) FROM family_members WHERE user_id = u.id) as family_ids, u.raw_user_meta_data as metadata FROM auth.users u LEFT JOIN public.profiles p ON u.id = p.id WHERE 1=1 AND u.email = $1
[UserModel.findOne] With params: [ 'jaroonwitpool@gmail.com' ]
[UserModel.findOne] Result rows: 1
[SystemConfig] Table public.system_configs missing. returning null for otp_config

================== [MOCK OTP EMAIL] ==================
To: jaroonwitpool@gmail.com
Subject: Your Login Code - Bondarys
Code/Data: {
  "firstName": "jaroonwit",
  "otp": "233607",
  "appName": "Bondarys"
}
======================================================

[AUTH] Login OTP for jaroonwitpool@gmail.com: 233607
[32minfo[39m: Request completed {"duration":"17ms","ip":"127.0.0.1","method":"POST","requestId":"88232283-285c-498f-a221-162777a9fcd5","service":"bondarys-api","statusCode":200,"timestamp":"2026-01-03T08:40:30.046Z","url":"/otp/request"}
[32minfo[39m: Request started {"ip":"127.0.0.1","method":"POST","requestId":"8ceabfcc-f5a7-40ee-b108-a6d87904aa9e","service":"bondarys-api","timestamp":"2026-01-03T08:40:38.517Z","url":"/api/v1/auth/otp/login","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36 Edg/143.0.0.0"}
[UserModel.findOne] Executing SQL: SELECT u.id, u.email, u.encrypted_password as password, u.created_at, u.email_confirmed_at, p.full_name, p.avatar_url, p.phone, (SELECT json_agg(family_id) FROM family_members WHERE user_id = u.id) as family_ids, u.raw_user_meta_data as metadata FROM auth.users u LEFT JOIN public.profiles p ON u.id = p.id WHERE 1=1 AND u.email = $1
[UserModel.findOne] With params: [ 'jaroonwitpool@gmail.com' ]
[UserModel.findOne] Result rows: 1
OTP Login failed: Error: Supabase client not initialized. Call initializeSupabase() first.
    at getSupabaseClient (E:\GitCloneProject\boundary\backend\src\services\supabaseService.ts:31:11)
    at AuthController.loginWithOtp (E:\GitCloneProject\boundary\backend\src\controllers\AuthController.ts:819:24)
    at processTicksAndRejections (node:internal/process/task_queues:103:5)
[32minfo[39m: Request completed {"duration":"20ms","ip":"127.0.0.1","method":"POST","requestId":"8ceabfcc-f5a7-40ee-b108-a6d87904aa9e","service":"bondarys-api","statusCode":500,"timestamp":"2026-01-03T08:40:38.537Z","url":"/otp/login"}
[32minfo[39m: Request started {"ip":"127.0.0.1","method":"GET","requestId":"29ad962d-5c0b-4e9d-991d-d38eb71f879d","service":"bondarys-api","timestamp":"2026-01-03T08:40:40.301Z","url":"/api/app-config/assets/logo_white","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36 Edg/143.0.0.0"}
[32minfo[39m: Request started {"ip":"127.0.0.1","method":"GET","requestId":"589c4de1-f833-44a8-9d9f-b1e3a2d8b3e5","service":"bondarys-api","timestamp":"2026-01-03T08:40:40.303Z","url":"/api/app-config/screens/login_screen","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36 Edg/143.0.0.0"}
[APP_CONFIG] Asset not found: logo_white. Returning fallback.
[32minfo[39m: Request completed {"duration":"6ms","ip":"127.0.0.1","method":"GET","requestId":"29ad962d-5c0b-4e9d-991d-d38eb71f879d","service":"bondarys-api","statusCode":304,"timestamp":"2026-01-03T08:40:40.307Z","url":"/assets/logo_white"}
[32minfo[39m: Request completed {"duration":"6ms","ip":"127.0.0.1","method":"GET","requestId":"589c4de1-f833-44a8-9d9f-b1e3a2d8b3e5","service":"bondarys-api","statusCode":304,"timestamp":"2026-01-03T08:40:40.309Z","url":"/screens/login_screen"}
